import pandas as pd
import re
from camel_tools.utils.dediac import dediac_ar
from camel_tools.tokenizers.word import simple_word_tokenize
from nltk.corpus import stopwords as nltk_stopwords

# Define Arabic stopwords
arabic_stopwords = set(nltk_stopwords.words('arabic'))
STOPWORDS = set([
     'في', 'من', 'على', 'و', 'ما', 'لا', 'الى', 'عن', 'أن', 'أو', 'إن', 
    'ب', 'ف', 'كان', 'قد', 'هذا', 'ذلك', 'هناك', 'إلى', 'هو', 'هي', 'هم', 
    'ها', 'لي', 'لك', 'لكم', 'لهم', 'إذ', 'إذا', 'لكن', 'ثم', 'أي', 'مع', 
    'كل', 'أيضا', 'عما', 'بما', 'بماذا', 'بمن', 'بمنذ', 'له', 'وهو', 'وهي', 'وهم',
    'هذه', 'هؤلاء', 'وهذا', 'وذلك', 'بين', 'إليك', 'إليهم', 'عند', 'حول', 'أمام',
    'تحت', 'فوق', 'خلال', 'ضد', 'بعد', 'قبل', 'منذ', 'أثناء', 'فيما', 'إلا', 'كما',
    'وإذا','إنما','وما','وإن','وإذ','وكيف','وأين','ومتى','وماذا','وكيفما','وأينما',
    'ومتىما','ومه','إني','به','ذاك','وإن','فإذا','فكيف','فأين','فمتى','فماذا',
    'فكيفما','فأينما','فمتىما','فمه','فإني','فبه','فذاك','فوإن','فلماذا','فكيفماذا','فأينماذا','بل','لو'
    'فلما','إنك','عني','لمن','أنت','أنتم','أنتما','أنتن','إياك','إياكم','إياكما','إياكن','إيانا','إياه',
    'إياهم',"ثم", "لكن", "بل",'اذا','ولا','لها',
    'له','لهم','لكم','لك','ها','هم','هي','هو','هذا','هذه','هناك','لما'
])
arabic_stopwordss = arabic_stopwords.union(STOPWORDS)

words = ['يا ابن آدم',
'وقال عمر بن الخطاب (رضي الله عنه)','قال عمر بن الخطاب (رضي الله عنه)','قال عمر بن الخطاب','رضي الله عنه','و كما قال الحسن البصري','كما قال الحسن البصري','قال الحسن البصري','وقال علي بن أبي طالب',
'وقال علي بن أبي طالب','قال علي بن أبي طالب','فقال','وكما قال عبد الله بن مسعود','كما قال عبد الله بن مسعود','قال أبو علي الدقاق','وقال أبو علي الدقاق','وكما قال عمر بن عبد العزيز','قال عمر بن عبد العزيز','وكما قال أبو محمد الجريري','قال أبو محمد الجريري','قال الحسن','الحِرمان. (الورّاق)','قال: الطَّمع فيها ثُمَّ لا ينالها','(الإمام جَعفر الصَّادق)',
'(أناتول فرانس)','(بوبليليوس سيروس)','(نابليون بونابرت)','(علي الطنطاوي)','(نبال قندس)','(عوف الكلبي)','(باولو كويلّو)','(مثل هولندي)','(ابن الأحمر)','(قول عربي)','(حديث صحيح)','(كاليماكوس)','(مثل فرنسي)','(سلفستر دوساسي)','(مثل إسباني)','(توماس بين)','(هاروكي موراكامي)','(جان جاك روسّو)','(حديث شريف- صحيح البخاري)','(شارلز ديكينز)','(باولو كويلّو)','(كوفي أنان)','(فوفنارغ)','(أكثم بن صيفي التَّميمي)','(عبد الله بن عمر)','(الإمام الشَّافعي','علي الطّنطاوي','روبرت سيرفس',
'مارلين فوس زافانت','علي بِن أبي طالِب','دعبل الخُزاعي','عمر أبو الغارات','عُمر بن الخطّاب','أبو العتاهية','ابن خُبيق الأنطاكي','الحرّالي','ابن القيّم','وَهب بن منبه','الحسن البصري','عُمر بن عبد العزيز','أبو العطاء السّندي','ابن عبّاس','خليل مطران','بكر بن عبدالله','هزّال القُريعي','مريد البرغوثي','الحرّالي','علي ين أبي طالب','لُقمان الحكيم','الإمام الشّافعي','هارون الرّشيد','ابن المقري','علي بن عبد العزيز القاضي الجرجاني','الحادرة الذبياني','ثابت بن قطنة','أبو حامٍ الغزالي','حديث نبوي - رواه مُسلم',
'العتبي الرشيد','يوهان دينه','أندريه موروا','فؤاد زكريَّا','عبّاس محمود العقّاد','أمين مَعلوف','وليَم شكسبير','ابن عاشور','حديث نبوي/ رواه البُخاريّ','المهاتما غاندي','فرانكلين روزفلت','مُنذِر القبَّاني','فريدريك نيتشه','فولتير','نِزار قبّاني','وليام شكسبير','روجر فريتس','مُصطفى مَحمود','مُحمَّد الرَّطبان','مارك توين','حديث شريف/ رواه أبو داود','[U+200F]','[9438] رواه ابنُ المبارك في   ((الزهد)) (2/19)، وأبو نعيم في ((حلية الأولياء)) (1/212) واللفظ له، وابن عساكر   في ((تاريخ دمشق)) (47/160).',
'رَضِيَ اللهُ عنه','قال أبو الدَّرداءِ','[9439] ((الدر المنثور)) للسيوطي   (1/61).','- وقال الحَسَنُ:)','- وقال الثَّوريُّ','[9440] ((الدر المنثور)) للسيوطي   (1/61)، ((حلية الأولياء)) لأبي نعيم (7/284) وفيه عن سفيانَ بنِ عُيَينةَ رحمه   اللهُ.','[9441] رواه أحمد في ((الورع))   (178).','- ورُويَ عن','ابنِ عُمَرَ','رَضِيَ اللهُ عنهما قال:','[9441] رواه أحمد في ((الورع))   (178).','وقال ميمونُ بنُ مِهرانَ:','[9442] ((الورع)) لأحمد بن حنبل   (ص: 53)، ((حلية الأولياء)) لأبي نعيم (4/84).','- وقال','سُفيانُ بنُ عُيَينةَ','[9443] ((الورع)) لأحمد بن حنبل   (ص: 146).',
'إبراهيمُ بنُ أدهَمَ','[9444] ((الرسالة القشيرية))   (1/233).','وقال إسحاقُ بنُ خَلَفٍ:','[9445] ((الزهد الكبير)) للبيهقي   (ص: 319)، ((تاريخ دمشق)) لابن عساكر (8/205).',
' وقال أبو سُلَيمانَ الدَّارانيُّ:','[9446] ((الزهد)) لابن أبي الدنيا   (ص: 159).','[9447] ((الزهد الكبير)) للبيهقي   (ص: 316).','وقال يحيى بنُ مُعاذٍ:','وقال: (الوَرَعُ على وجهينِ:','[9448] ((الزهد الكبير)) للبيهقي   (ص: 318).','[9449] ((الرسالة القشيرية))   (1/234).','[9450] ((الرسالة القشيرية))   (1/235).','يونُسُ بنُ عُبيدٍ:','[9450] ((الرسالة القشيرية))   (1/235).','سُفيانُ'
'الثَّوريُّ','[9451] ((الرسالة القشيرية))   (1/235).','وقال الحَسَنُ:','[9452] ((الرسالة القشيرية))   (1/236).','وقال أبو هُرَيرةَ رَضِيَ اللهُ عنه:','[9453] ذكره القشيري في ((الرسالة   القشيرية)) (1/236).','وقال بعضُ الصَّحابةِ:','[9454] ((إحياء علوم الدين))   للغزالي (4/490)، ((مدارج السالكين)) لابن القيم (2/25).','[9455] ((مدارج السالكين)) لابن   القيم (2/25).','وقال الهَرَويُّ:','وقال ابنُ مِسكَوَيهِ:','[9456] ((تهذيب الأخلاق)) (ص:   29).','وقال سُفيانُ:','[9457] ((الورع)) لابن أبي الدنيا   (ص: 112).','أقوال الإمام',
'صلى الله سلم الله قال','رواه مسلم', 'قيل للحسن البصري رحمه الله  قال','عمر قال','يقال','النبي صلى الله سلم قال','عبد الله بن مسعود ','حكيم بن حزام النبي صلى الله سلم قال ','عبد الله بن عمرو بن العاص','عبد الله بن عمرو بن العاص قال' ,'أخبرني سفيان هرقل قال','الحسن بن علي قال',' الإمام علي بن أبى طالب كرم الله جهه'
]

# Function to replace specific characters
def remplacer_caracteres(texte):
    return texte.replace('ء', 'ا').replace('ؤ', 'ا')

# Function to preprocess Arabic text
def preprocess_arabic_text(text):
    # Replace specified characters
    text = remplacer_caracteres(text)
    # Remove diacritics
    text = dediac_ar(text)
    # Remove non-Arabic characters and special characters
    text = re.sub(r'[^\u0621-\u064A\s]', '', text)
    # Remove "و" when it starts a word
    text = re.sub(r'\bو', '', text)
    # Tokenize and remove stopwords
    words = simple_word_tokenize(text)
    words = [word for word in words if word not in arabic_stopwordss]
    # Join words back to a single string
    return words

# Function to remove specified phrases from text
def remove_phrases(text, phrases):
    for phrase in phrases:
        text = text.replace(phrase, '')  # Remove each phrase
    return text

# Load and clean your CSV file
df = pd.read_csv('manners.csv')

# Drop duplicates and missing values
df = df.drop_duplicates(subset=['Citation']).dropna()

# Apply preprocessing to the 'Citation' column
df['Citation'] = df['Citation'].apply(lambda x: remove_phrases(x, words))
df['Cleaned_Citation'] = df['Citation'].apply(preprocess_arabic_text)

# Save the cleaned DataFrame to a new CSV
df.to_csv('cleaned_manners.csv', index=False, encoding='utf-8')
